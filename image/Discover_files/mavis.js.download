class Mavis{constructor(){this.MERCHANT_ID=75,this.URL_PARAMS=new URLSearchParams(window.location.search),this.UTM_PARAMS={},this.API_HEADERS=[["Content-type","application/json"],["X-N8N-TOKEN","pDFsCT6G2Xea4qCxKf6EQc3Mrj"]],this.getUtmParams(),this.getOrder()}apiRequest(method,url,data,success,error,complete=null){var xhttp=new XMLHttpRequest;xhttp.open(method,url,!0),this.API_HEADERS.forEach(header=>{xhttp.setRequestHeader(header[0],header[1])}),xhttp.onreadystatechange=function(){xhttp.readyState===4&&(xhttp.status===200?success(JSON.parse(this.responseText)):error(JSON.parse(this.responseText)),complete&&complete())},xhttp.send(JSON.stringify(data))}setLocalStorage(key,value,expiry_hrs){var expires=new Date;expires.setTime(expires.getTime()+expiry_hrs*60*60*1e3),expires=expires.toUTCString(),localStorage.setItem(key,JSON.stringify({value,expires}))}getLocalStorage(key){try{var _data=JSON.parse(localStorage.getItem(key)),now=new Date().getTime(),expires=Date.parse(_data.expires);return expires>now?_data.value:(this.deleteLocalStorage(key),null)}catch{return null}}deleteLocalStorage(key){localStorage.removeItem(key)}getUtmParams(){var utmParams={};return["utm_source","utm_medium","utm_campaign","utm_content","utm_term","aid","ad_id"].forEach(utmParam=>{this.URL_PARAMS.get(utmParam)&&(utmParams[utmParam]=this.URL_PARAMS.get(utmParam))}),Object.keys(utmParams).length==0?utmParams=this.getLocalStorage("mavisdata"):(utmParams.aid=utmParams.aid||utmParams.ad_id,delete utmParams.ad_id,this.setLocalStorage("mavisdata",utmParams,24*7)),this.UTM_PARAMS=utmParams||{},this.UTM_PARAMS}getOrder(){this.ORDER={order_id:"{{ order.id }}",total_price:"{{ order.total_price }}",total_quantity:"{{ order.item_count }}",created_at:"{{ order.created_at }}"},isNaN(parseInt(this.ORDER.order_id))?this.ORDER=null:this.ORDER.total_price=parseFloat(this.ORDER.total_price)/100}capture(event){var data={merchant_id:this.MERCHANT_ID,utm_params:this.UTM_PARAMS};switch(event){case"order_conversion":data.page_url=window.location.href,data.order=this.ORDER;break}console.log("+++++++++++++++++++++++++++++++++++++++++++++++"),jitsu("track",event,{mavis:data})}pageLoad(){try{this.ORDER!=null&&this.capture("order_conversion")}catch(err){console.log(err)}}}var mavis=new Mavis;window.addEventListener("load",function(){mavis.pageLoad()});
//# sourceMappingURL=/cdn/shop/t/316/assets/mavis.js.map?v=169274885023757472831707102784
